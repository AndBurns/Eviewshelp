<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <title>Nonlinear Two-stage Least Squares</title>
    <link rel="StyleSheet" href="css/gmmiv.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/seealso.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/popup.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/page.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        function  WWNoOp() {}
        function  WWNoValue() { return ""; }


        var  WebWorksHTMLHelp;
        var  WebWorksSeeAlso;
        var  WebWorksDropDown;


        if (typeof(HTMLHelp_Object) != "undefined")
        {
          WebWorksHTMLHelp = new HTMLHelp_Object();
          WebWorksSeeAlso  = new WebWorksSeeAlso_Object();
          WebWorksDropDown = new WebWorksDropDown_Object();
        }
        else
        {
          WebWorksHTMLHelp = new Object();
          WebWorksHTMLHelp.fNotifyClicked = WWNoOp;
          WebWorksHTMLHelp.fPopupDivTag   = WWNoValue;

          WebWorksSeeAlso = new Object();

          WebWorksDropDown = new Object();
          WebWorksDropDown.fWriteArrow  = WWNoOp;
          WebWorksDropDown.fWriteDIVOpen  = WWNoOp;
          WebWorksDropDown.fWriteDIVClose = WWNoOp;
        }
      // -->
    </script>
  </head>
  <body onclick="javascript:WebWorksHTMLHelp.fNotifyClicked();">
    <table cellspacing="0" align="left">
      <tr>
        <td>
          <a href="gmmiv-Two-stage_Least_Squares.html"><img src="images/prev.gif" alt="Previous" border="0" /></a>
        </td>
        <td>
          <a href="gmmiv-Limited_Information_Maximum_Likelihood_and_K-Cla.html"><img src="images/next.gif" alt="Next" border="0" /></a>
        </td>
      </tr>
    </table>
    <br clear="all" />
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="preface.html">User&#8217;s Guide</a> : <a class="WebWorks_Breadcrumb_Link" href="sec_basc.html">Basic Single Equation Analysis</a> : <a class="WebWorks_Breadcrumb_Link" href="gmmiv-Instrumental_Variables_and_GMM.html">Instrumental Variables and GMM</a> : Nonlinear Two-stage Least Squares</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading_3"><a name="177316">Nonlinear Two-stage Least Squares</a></div>
      <div class="WebWorks_MiniTOC">
        <div class="WebWorks_MiniTOC_Level1">
          <a class="WebWorks_MiniTOC_Link" href="#177485">How to Estimate Nonlinear TSLS in EViews</a>
        </div>
        <div class="WebWorks_MiniTOC_Level1">
          <a class="WebWorks_MiniTOC_Link" href="#177480">Nonlinear Two-stage Least Squares with ARMA errors</a>
        </div>
        <div class="WebWorks_MiniTOC_Level1">
          <a class="WebWorks_MiniTOC_Link" href="#177650">Weighted Nonlinear Two-stage Least Squares</a>
        </div>
      </div>
      <div class="Body_Text"><a name="177317">Nonlinear two-stage least squares refers to an instrumental variables procedure for estimating nonlinear regression models involving functions of endogenous and exogenous variables and parameters. Suppose we have the usual nonlinear regression model:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/gmmiv.032.4.01.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(23.10)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="177331">where <img class="Default EquationGraphic" src="images/gmmiv.032.4.02.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 15px; top: 0.0pt" alt="" /> is a <img class="Default EquationGraphic" src="images/gmmiv.032.4.03.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 13px; top: 0.0pt" alt="" />-dimensional vector of parameters, and <img class="Default EquationGraphic" src="images/gmmiv.032.4.04.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 18px; top: 0.0pt" alt="" /> contains both exogenous and endogenous variables. In matrix form, if we have <img class="Default EquationGraphic" src="images/gmmiv.032.4.05.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 45px; top: 0.0pt" alt="" /> instruments <img class="Default EquationGraphic" src="images/gmmiv.032.4.06.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 17px; top: 0.0pt" alt="" />, nonlinear two-stage least squares minimizes:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/gmmiv.032.4.07.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(23.11)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="177345">with respect to the choice of <img class="Default EquationGraphic" src="images/gmmiv.032.4.08.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 15px; top: 0.0pt" alt="" />.</a></div>
      <div class="Body_Text"><a name="177346">While there is no closed form solution for the parameter estimates, the parameter estimates satisfy the first-order conditions:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/gmmiv.032.4.09.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(23.12)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="177351">with estimated covariance given by:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/gmmiv.032.4.10.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(23.13)</div>
          </td>
        </tr>
      </table>
      <div class="Heading_4"><a name="177485">How to Estimate Nonlinear TSLS in EViews</a></div>
      <div class="Body_Text"><a name="177486">To estimate a Nonlinear equation using TSLS simply select </a><span class="Menu_Item">Object/New Object.../Equation&#8230;</span> or <span class="Menu_Item">Quick/Estimate Equation&#8230;</span> Choose <span class="Dialog_Item">TSLS</span> from the <span class="Dialog_Item">Method</span> dropdown menu, enter your nonlinear specification and the list of instruments. Click <span class="Dialog_Item">OK</span>.</div>
      <div class="Body_Text"><a name="177487">With nonlinear two-stage least squares estimation, you have a great deal of flexibility with your choice of instruments. Intuitively, you want instruments that are correlated with the derivatives <img class="Default EquationGraphic" src="images/gmmiv.032.4.11.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 42px; top: 0.0pt" alt="" />. Since <img class="Default EquationGraphic" src="images/gmmiv.032.4.12.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 18px; top: 0.0pt" alt="" /> is nonlinear, you may begin to think about using more than just the exogenous and predetermined variables as instruments. Various nonlinear functions of these variables, for example, cross-products and powers, may also be valid instruments. One should be aware, however, of the possible finite sample biases resulting from using too many instruments.</a></div>
      <div class="Heading_4"><a name="177480">Nonlinear Two-stage Least Squares with ARMA errors</a></div>
      <div class="Body_Text"><a name="177266">While we will not go into much detail here, note that EViews can estimate non-linear TSLS models where there are ARMA error terms.</a></div>
      <div class="Body_Text"><a name="177267">To estimate your model, simply open your equation specification window, and enter your nonlinear specification, including all ARMA terms, and provide your instrument list. For example, you could enter the regression specification:</a></div>
      <div class="Input"><a name="177268">cs = exp(c(1) + gdp^c(2)) + [ar(1)=c(3), ma(1)=c(4)]</a></div>
      <div class="Body_Text"><a name="177269">with the instrument list:</a></div>
      <div class="Input"><a name="177270">c gov</a></div>
      <div class="Body_Text"><a name="181255">EViews will transform the nonlinear regression model as described in </a><span class="Link"><a href="timeser-Estimating_ARIMA_and_ARFIMA_Models_in_EViews.html#246532" title="Estimating ARIMA and ARFIMA Models in EViews">&#8220;Specifying AR Terms&#8221;</a></span>, and then estimate nonlinear TSLS on the transformed specification. For nonlinear models with AR errors, EViews uses a Gauss-Newton algorithm. See <span class="Link"><a href="optimize-Optimization_Algorithms.html#137130" title="Optimization Algorithms">&#8220;Optimization Algorithms&#8221;</a></span> for further details.</div>
      <div class="Heading_4"><a name="177650">Weighted Nonlinear Two-stage Least Squares</a></div>
      <div class="Body_Text"><a name="177651">Weights may be used in nonlinear two-stage least squares estimation, provided there are no ARMA terms. Simply add weighting to your nonlinear TSLS specification above by pressing the </a><span class="Menu_Item">Options </span>button and entering the weight specification (see <span class="Link"><a href="Regress2-Weighted_Least_Squares.html#266407" title="Weighted Least Squares">&#8220;Weighted Least Squares&#8221;</a></span>).</div>
      <div class="Body_Text"><a name="177652">The objective function for weighted TSLS is,</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/gmmiv.032.4.13.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(23.14)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="177657">The default reported standard errors are based on the covariance matrix estimate given by:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/gmmiv.032.4.14.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(23.15)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="177665">where <img class="Default EquationGraphic" src="images/gmmiv.032.4.15.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 103px; top: 0.0pt" alt="" />.</a></div>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
      document.write(WebWorksHTMLHelp.fPopupDivTag());
     // -->
    </script>
  </body>
</html>