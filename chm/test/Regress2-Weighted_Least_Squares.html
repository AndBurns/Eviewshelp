<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <title>Weighted Least Squares</title>
    <link rel="StyleSheet" href="css/Regress2.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/seealso.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/popup.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/page.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        function  WWNoOp() {}
        function  WWNoValue() { return ""; }


        var  WebWorksHTMLHelp;
        var  WebWorksSeeAlso;
        var  WebWorksDropDown;


        if (typeof(HTMLHelp_Object) != "undefined")
        {
          WebWorksHTMLHelp = new HTMLHelp_Object();
          WebWorksSeeAlso  = new WebWorksSeeAlso_Object();
          WebWorksDropDown = new WebWorksDropDown_Object();
        }
        else
        {
          WebWorksHTMLHelp = new Object();
          WebWorksHTMLHelp.fNotifyClicked = WWNoOp;
          WebWorksHTMLHelp.fPopupDivTag   = WWNoValue;

          WebWorksSeeAlso = new Object();

          WebWorksDropDown = new Object();
          WebWorksDropDown.fWriteArrow  = WWNoOp;
          WebWorksDropDown.fWriteDIVOpen  = WWNoOp;
          WebWorksDropDown.fWriteDIVClose = WWNoOp;
        }
      // -->
    </script>
  </head>
  <body onclick="javascript:WebWorksHTMLHelp.fNotifyClicked();">
    <table cellspacing="0" align="left">
      <tr>
        <td>
          <a href="Regress2-Robust_Standard_Errors.html"><img src="images/prev.gif" alt="Previous" border="0" /></a>
        </td>
        <td>
          <a href="Regress2-Nonlinear_Least_Squares.html"><img src="images/next.gif" alt="Next" border="0" /></a>
        </td>
      </tr>
    </table>
    <br clear="all" />
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="preface.html">User&#8217;s Guide</a> : <a class="WebWorks_Breadcrumb_Link" href="sec_basc.html">Basic Single Equation Analysis</a> : <a class="WebWorks_Breadcrumb_Link" href="Regress2-Additional_Regression_Tools.html">Additional Regression Tools</a> : Weighted Least Squares</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading_3"><a name="266407">Weighted Least Squares</a></div>
      <div class="Body_Text"><a name="266409">Suppose that you have heteroskedasticity of known form, where the conditional error variances are given by <img class="Default EquationGraphic" src="images/Regress2.030.4.01.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 31px; max-width: 20px; top: 0.0pt" alt="" />. The presence of heteroskedasticity does not alter the bias or consistency properties of ordinary least squares estimates, but OLS is no longer efficient and conventional estimates of the coefficient standard errors are not valid.</a></div>
      <div class="Body_Text"><a name="266416">If the variances <img class="Default EquationGraphic" src="images/Regress2.030.4.02.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 31px; max-width: 20px; top: 0.0pt" alt="" /> are known up to a positive scale factor, you may use weighted least squares (WLS) to obtain efficient estimates that support valid inference. Specifically, if</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/Regress2.030.4.03.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(21.22)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="266427">and we observe <img class="Default EquationGraphic" src="images/Regress2.030.4.04.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 31px; max-width: 72px; top: 0.0pt" alt="" />, the WLS estimator for <img class="Default EquationGraphic" src="images/Regress2.030.4.05.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 15px; top: 0.0pt" alt="" /> minimizes the weighted sum-of-squared residuals:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/Regress2.030.4.06.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(21.23)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="266442">with respect to the <img class="Default EquationGraphic" src="images/Regress2.030.4.07.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 13px; top: 0.0pt" alt="" />-dimensional vector of parameters <img class="Default EquationGraphic" src="images/Regress2.030.4.08.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 15px; top: 0.0pt" alt="" />, where the weights <img class="Default EquationGraphic" src="images/Regress2.030.4.09.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 84px; top: 0.0pt" alt="" /> are proportional to the inverse conditional variances. Equivalently, you may estimate the regression of the square-root weighted transformed data <img class="Default EquationGraphic" src="images/Regress2.030.4.10.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 29px; max-width: 109px; top: 0.0pt" alt="" /> on the transformed <img class="Default EquationGraphic" src="images/Regress2.030.4.11.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 29px; max-width: 108px; top: 0.0pt" alt="" />.</a></div>
      <div class="Body_Text"><a name="266455">In matrix notation, let <img class="Default EquationGraphic" src="images/Regress2.030.4.12.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 22px; top: 0.0pt" alt="" /> be a diagonal matrix containing the scaled <img class="Default EquationGraphic" src="images/Regress2.030.4.13.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 16px; top: 0.0pt" alt="" /> along the diagonal and zeroes elsewhere, and let <img class="Default EquationGraphic" src="images/Regress2.030.4.14.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 13px; top: 0.0pt" alt="" /> and <img class="Default EquationGraphic" src="images/Regress2.030.4.15.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 18px; top: 0.0pt" alt="" /> be the matrices associated with <img class="Default EquationGraphic" src="images/Regress2.030.4.16.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 18px; top: 0.0pt" alt="" /> and <img class="Default EquationGraphic" src="images/Regress2.030.4.17.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 18px; top: 0.0pt" alt="" />. The WLS estimator may be written,</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/Regress2.030.4.18.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(21.24)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="266473">and the default estimated coefficient covariance matrix is:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/Regress2.030.4.19.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(21.25)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="266479">where </a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/Regress2.030.4.20.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(21.26)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="266484">is a d.f. corrected estimator of the weighted residual variance. </a></div>
      <div class="Body_Text"><a name="266485">To perform WLS in EViews, open the equation estimation dialog and select a method that supports WLS such as </a><span class="Menu_Item">LS&#8212;Least Squares (NLS and ARMA),</span> then click on the <span class="Menu_Item">Options</span> tab. (You should note that weighted estimation is not offered in equations containing ARMA specifications, nor is it available for some equation methods, such as those estimated with ARCH, binary, count, censored and truncated, or ordered discrete choice techniques.)</div>
      <div class="Body_Text"><a name="266486">You will use the three parts of the </a><span class="Menu_Item">Weights</span> section of the <span class="Menu_Item">Options</span> tab to specify your weights. </div>
      <div class="Picture"><a name="266490"><img class="Default" src="images/Regress2.030.4.21.jpg" width="100%" style="left: 0.0pt; max-height: 92px; max-width: 135px; top: 0.0pt" alt="" /></a></div>
      <div class="Body_Text"><a name="266492">The </a><span class="Menu_Item">Type</span> dropdown is used to specify the form in which the weight data are provided. If, for example, your weight series VARWGT contains values proportional to the conditional variance, you should select <span class="Menu_Item">Variance</span>. Alternately, if your series INVARWGT contains the values proportional to the inverse of the standard deviation of the residuals you should choose <span class="Menu_Item">Inverse std. dev. </span></div>
      <div class="Body_Text"><a name="266493">Next, you should enter an expression for your weight series in the </a><span class="Menu_Item">Weight series</span> edit field.</div>
      <div class="Picture"><a name="266497"><img class="Default" src="images/Regress2.030.4.22.jpg" width="100%" style="left: 0.0pt; max-height: 66px; max-width: 135px; top: 0.0pt" alt="" /></a></div>
      <div class="Body_Text"><a name="266499">Lastly, you should choose a scaling method for the weights. There are three choices: </a><span class="Menu_Item">Average</span>, <span class="Menu_Item">None</span>, and (in some cases) <span class="Menu_Item">EViews default</span>. If you select <span class="Menu_Item">Average</span>, EViews will, prior to use, scale the weights so that the <img class="Default EquationGraphic" src="images/Regress2.030.4.23.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 21px; top: 0.0pt" alt="" /> sum to <img class="Default EquationGraphic" src="images/Regress2.030.4.24.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 17px; top: 0.0pt" alt="" />. The <span class="Menu_Item">EViews default</span> specification scales the weights so the square roots of the <img class="Default EquationGraphic" src="images/Regress2.030.4.25.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 21px; top: 0.0pt" alt="" /> sum to <img class="Default EquationGraphic" src="images/Regress2.030.4.26.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 22px; max-width: 17px; top: 0.0pt" alt="" />. (The latter square root scaling, which offers backward compatibility to EViews 6 and earlier, was originally introduced in an effort to make the weighted residuals <img class="Default EquationGraphic" src="images/Regress2.030.4.27.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 29px; max-width: 119px; top: 0.0pt" alt="" /> comparable to the unweighted residuals.) Note that the EViews default method is only available if you select <span class="Menu_Item">Inverse std. dev.</span> as weighting <span class="Menu_Item">Type</span>.</div>
      <div class="Block_Quote"><a name="266515">Unless there is good reason to do so, we recommend that you employ </a><span class="Menu_Item">Inverse std. dev. weights</span> with <span class="Menu_Item">EViews default</span> scaling, even if it means you must transform your weight series. The other weight types and scaling methods were introduced in EViews 7, so equations estimated using the alternate settings may not be read by prior versions of EViews.</div>
      <div class="Body_Text"><a name="266522">We emphasize the fact that <img class="Default EquationGraphic" src="images/Regress2.030.4.28.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 25px; max-width: 41px; top: 0.0pt" alt="" /> and <img class="Default EquationGraphic" src="images/Regress2.030.4.29.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 26px; max-width: 44px; top: 0.0pt" alt="" /> are almost always invariant to the scaling of weights. One important exception to this invariance occurs in the special case where some of the weight series values are non-positive since observations with non-positive weights will be excluded from the analysis unless you have selected </a><span class="Menu_Item">EViews default</span> scaling, in which case only observations with zero weights are excluded.</div>
      <div class="Body_Text"><a name="266523">As an illustration, we consider a simple example taken from Gujarati (2003, Example 11.7, p. 416) which examines the relationship between compensation (Y) and index for employment size (X) for nine nondurable manufacturing industries. The data, which are in the workfile &#8220;Gujarati_wls.WF1&#8221;, also contain a series SIGMA believed to be proportional to the standard deviation of each error. </a></div>
      <div class="Body_Text"><a name="266524">To estimate WLS for this specification, open an equation dialog and enter</a></div>
      <div class="Input"><a name="266525">y c x</a></div>
      <div class="Body_Text"><a name="266526">as the equation specification. </a></div>
      <div class="Picture"><a name="266530"><img class="Default" src="images/Regress2.030.4.30.jpg" width="100%" style="left: 0.0pt; max-height: 173px; max-width: 218px; top: 0.0pt" alt="" /></a></div>
      <div class="Body_Text"><a name="266531">Click on the </a><span class="Menu_Item">Options</span> tab, and fill out the <span class="Menu_Item">Weights</span> section as depicted here. We select <span class="Menu_Item">Inverse std. dev.</span> as our <span class="Menu_Item">Type</span>, and specify &#8220;1/SIGMA&#8221; for our <span class="Menu_Item">Weight series</span>. Lastly, we select <span class="Menu_Item">EViews default</span> as our <span class="Menu_Item">Scaling</span> method.</div>
      <div class="Body_Text"><a name="266532">Click on </a><span class="Menu_Item">OK</span> to estimate the specified equation. The results are given by:</div>
      <div class="Table"><a name="266536"><img class="Default" src="images/Regress2.030.4.31.jpg" width="100%" style="left: 0.0pt; max-height: 575px; max-width: 1004px; top: 0.0pt" alt="" /></a></div>
      <div class="Body_Text"><a name="266537">The top portion of the output displays the estimation settings which show both the specified weighting series and the type of weighting employed in estimation. The middle section shows the estimated coefficient values and corresponding standard errors, </a><span class="In-line_math">t</span>-statistics and probabilities.</div>
      <div class="Body_Text"><a name="266541">The bottom portion of the output displays two sets of statistics. The </a><span class="Menu_Item">Weighted Statistics</span> show statistics corresponding to the actual estimated equation. For purposes of discussion, there are two types of summary statistics: those that are (generally) invariant to the scaling of the weights, and those that vary with the weight scale.</div>
      <div class="Body_Text"><a name="266542">The &#8220;R-squared&#8221;, &#8220;Adjusted R-squared&#8221;, &#8220;F-statistic&#8221; and &#8220;Prob(F-stat)&#8221;, and the &#8220;Durbin-Watson stat&#8221;, are all invariant to your choice of scale. Notice that these are all fit measures or test statistics which involve ratios of terms that remove the scaling. </a></div>
      <div class="Body_Text"><a name="266543">One additional invariant statistic of note is the &#8220;Weighted mean dep.&#8221; which is the weighted mean of the dependent variable, computed as:</a></div>
      <table style="width: 90%; margin-left: 80px; margin-right: 80px;">
        <tr>
          <td style="padding-left: 5%; text-align: left;">
            <img src="images/Regress2.030.4.32.jpg" class="EquationGraphic" style="border: 0px; vertical-align: baseline;" />
          </td>
          <td style="padding-right: 20px; text-align: right;">
            <div style="font-weight: normal; font-size: small; font-family: Verdana, Serif;">(21.27)</div>
          </td>
        </tr>
      </table>
      <div class="Body_Text"><a name="266548">The weighted mean is the value of the estimated intercept in the restricted model, and is used in forming the reported </a><span class="In-line_math">F</span>-test.</div>
      <div class="Body_Text"><a name="266552">The remaining statistics such as the &#8220;Mean dependent var.&#8221;, &#8220;Sum squared resid&#8221;, and the &#8220;Log likelihood&#8221; all depend on the choice of scale. They may be thought of as the statistics computed using the weighted data, <img class="Default EquationGraphic" src="images/Regress2.030.4.33.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 29px; max-width: 109px; top: 0.0pt" alt="" /> and <img class="Default EquationGraphic" src="images/Regress2.030.4.34.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 29px; max-width: 108px; top: 0.0pt" alt="" />. For example, the mean of the dependent variable is computed as <img class="Default EquationGraphic" src="images/Regress2.030.4.35.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 44px; max-width: 100px; top: 0.0pt" alt="" />, and the sum-of-squared residuals is given by <img class="Default EquationGraphic" src="images/Regress2.030.4.36.jpg" width="100%" style="display: inline; left: 0.0pt; max-height: 35px; max-width: 141px; top: 0.0pt" alt="" />. These values should not be compared across equations estimated using different weight scaling.</a></div>
      <div class="Body_Text"><a name="266565">Lastly, EViews reports a set of </a><span class="Menu_Item">Unweighted Statistics</span>. As the name suggests, these are statistics computed using the unweighted data and the WLS coefficients.</div>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
      document.write(WebWorksHTMLHelp.fPopupDivTag());
     // -->
    </script>
  </body>
</html>